<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>30秒脳トレ（正月編）：3択クイズ</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --text:#1a1d2a; --muted:#667085;
      --primary:#2563eb; --primary2:#1d4ed8;
      --ok:#16a34a; --ng:#dc2626; --border:#e6e8ef;
      --shadow: 0 10px 30px rgba(20, 20, 40, .08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic UI","Yu Gothic",Meiryo,sans-serif;
      background: linear-gradient(180deg, #f6f7fb 0%, #ffffff 70%);
      color:var(--text);
      line-height:1.5;
    }
    .wrap{max-width:820px;margin:0 auto;padding:18px 14px 44px;}
    header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin:8px 2px 14px;}
    .title{display:flex;flex-direction:column;gap:6px;}
    h1{font-size:20px;margin:0;letter-spacing:.2px;}
    .sub{font-size:13px;color:var(--muted);margin:0;}
    .pill{
      display:flex;align-items:center;gap:10px;justify-content:center;
      background: rgba(37,99,235,.08);
      border: 1px solid rgba(37,99,235,.18);
      padding: 10px 12px;border-radius:999px;
      font-weight:800;color:var(--primary2);min-width:150px;user-select:none;
    }
    .pill .num{font-variant-numeric: tabular-nums;font-size:16px;}
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:var(--radius);box-shadow:var(--shadow);
      padding:16px;
    }
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:10px;}
    .progress{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:13px;user-select:none;}
    .bar{width:200px;height:8px;background:#eef0f6;border-radius:999px;overflow:hidden;}
    .bar > div{height:100%;width:0%;background:var(--primary);transition: width .25s ease;}
    .q{margin:10px 0 12px;font-size:18px;font-weight:900;letter-spacing:.2px;}
    .hint{margin:0 0 14px;font-size:13px;color:var(--muted);}
    .answers{display:grid;grid-template-columns:1fr;gap:10px;margin-top:8px;}
    button{
      appearance:none;border:1px solid var(--border);background:#fff;border-radius:14px;
      padding:12px 12px;font-size:16px;font-weight:800;color:var(--text);
      cursor:pointer;text-align:left;transition: transform .02s ease, border-color .2s ease, background .2s ease;
    }
    button:active{transform: translateY(1px);}
    button:focus{outline:3px solid rgba(37,99,235,.18);outline-offset:2px;}
    .btn-primary{background:var(--primary);border-color: rgba(37,99,235,.6);color:#fff;text-align:center;}
    .btn-primary:hover{background:var(--primary2);}
    .btn-ghost{background:#fff;color:var(--primary2);border-color: rgba(37,99,235,.25);text-align:center;}
    .btn-ghost:hover{background: rgba(37,99,235,.06);}
    .state{
      margin-top:12px;padding:12px;border-radius:14px;border:1px solid var(--border);
      background:#fafbff;display:none;
    }
    .state.show{display:block;}
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      font-weight:900;padding:6px 10px;border-radius:999px;font-size:13px;
      border:1px solid var(--border);background:#fff;user-select:none;
    }
    .badge.ok{color:var(--ok);border-color: rgba(22,163,74,.25);background: rgba(22,163,74,.06);}
    .badge.ng{color:var(--ng);border-color: rgba(220,38,38,.22);background: rgba(220,38,38,.06);}
    .explain{margin-top:8px;color:var(--text);font-size:14px;}
    .footer-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;}
    .footer-actions button{flex:1 1 180px;text-align:center;}
    .result{display:none;margin-top:14px;}
    .result.show{display:block;}
    .result h2{margin:0 0 8px;font-size:18px;}
    .result p{margin:6px 0;color:var(--muted);font-size:14px;}
    .list{margin-top:10px;border-top:1px dashed var(--border);padding-top:10px;display:grid;gap:10px;}
    .item{padding:10px;border:1px solid var(--border);border-radius:14px;background:#fff;}
    .item .top{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:6px;}
    .item .t{font-weight:900;font-size:14px;}
    .item .a{font-size:13px;color:var(--muted);}
    .toast{
      position:fixed;left:50%;bottom:16px;transform:translateX(-50%);
      background: rgba(20, 20, 40, .92);color:#fff;padding:10px 12px;border-radius:999px;
      font-size:13px;opacity:0;pointer-events:none;transition: opacity .18s ease;
      max-width: calc(100% - 24px);text-align:center;
    }
    .toast.show{opacity:1;}
    @media (min-width: 640px){
      h1{font-size:22px;}
      .answers{grid-template-columns:1fr 1fr 1fr;}
      button{text-align:center;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>脳トレ（お正月編）：3択クイズ（全5問）</h1>
        <p class="sub">直感でOK。1問あたり5〜10秒くらいのテンポでどうぞ。</p>
      </div>
      <div class="pill" aria-label="残り時間">
        <span>残り</span><span class="num" id="timeLeft">45</span><span>秒</span>
      </div>
    </header>

    <main class="card" role="main" aria-live="polite">
      <div class="row">
        <div class="progress">
          <span id="qIndex">1</span>/<span id="qTotal">5</span>問
          <div class="bar" aria-hidden="true"><div id="barFill"></div></div>
        </div>
        <div class="progress" title="正解数">
          スコア：<span id="scoreNow">0</span>
        </div>
      </div>

      <div class="q" id="questionText">ここに問題文</div>
      <div class="hint" id="questionHint">※ヒントや補足</div>

      <div class="answers" id="answers"></div>

      <div class="state" id="feedback">
        <div><span class="badge" id="badge">判定</span></div>
        <div class="explain" id="explainText"></div>
        <div class="footer-actions">
          <button class="btn-primary" id="nextBtn">次へ</button>
        </div>
      </div>

      <div class="result" id="result">
        <h2>結果</h2>
        <p>
          <strong id="finalScore">0</strong> / <span id="finalTotal">5</span> 正解　
          （回答時間：<span id="elapsed">0</span>秒）
        </p>
        <p id="message">おつかれさまでした！</p>

        <div class="footer-actions">
          <button class="btn-primary" id="restartBtn">もう一度やる</button>
          <button class="btn-ghost" id="copyBtn">結果をコピー</button>
        </div>

        <div class="list" id="review"></div>
      </div>
    </main>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // =======================
    // ここを差し替えるだけで毎号運用できます
    // =======================
    const QUIZ = [
  {
    q: "Q1. 『寝だめ』について、一般的に一番近いのは？",
    hint: "正月休みにありがちな“やりがち”を想定",
    a: ["睡眠の質も量も、平日分を完全に取り戻せる", "疲労感は和らぐことはあるが、体内時計はずれやすい", "寝だめは必ず不眠を引き起こす"],
    correct: 1,
    explain: "長く寝て疲労感が軽くなることはありますが、起床時刻が大きくずれると生活リズムが乱れやすいです。"
  },
  {
    q: "Q2. おせち・鍋・外食が続いた時、“翌日のむくみ”に影響しやすい要素は？",
    hint: "原因が1つではないとき、どれが近い？",
    a: ["塩分（ナトリウム）", "食物繊維", "香辛料（辛さ）"],
    correct: 0,
    explain: "塩分が多い食事が続くと、体内の水分バランスに影響し、むくみを感じやすくなることがあります。"
  },
  {
    q: "Q3. 正月の“飲酒量が増えた”とき、翌朝のパフォーマンス低下に関わりやすいのは？",
    hint: "体質差はあるが、一般的な傾向として",
    a: ["睡眠が浅くなりやすい", "必ず筋肉量が増える", "視力が永久に落ちる"],
    correct: 0,
    explain: "アルコールは寝つきを良く感じさせても、睡眠が浅くなりやすいと言われます。結果として翌朝の集中力に影響することがあります。"
  },
  {
    q: "Q4. 『脳の省エネ』に関わる行動として、日常で起きやすいのは？",
    hint: "“脳が楽をしたがる”現象を選ぶ",
    a: ["同じ道・同じ行動を選びがちになる", "新しいことに挑戦すると必ずストレスがゼロになる", "考えるほど代謝が下がり続ける"],
    correct: 0,
    explain: "人は慣れた選択を取りやすい傾向があります。たまに“いつもと違う”を混ぜると刺激になります。"
  },
  {
    q: "Q5. 1日3分でも『正月明けの習慣リセット』に効きやすいのはどれ？",
    hint: "継続しやすさも含めて考える",
    a: ["起床後に明るい光を浴びる", "夕方以降に甘いものだけ食べる", "夜遅くにスマホを長時間見る"],
    correct: 0,
    explain: "朝の光は生活リズムを整える助けになります。短時間でも“毎日”が強いです。"
  }
];

    // =======================

    const TOTAL_TIME_SEC = 45; // 5問なら45秒がちょうどよい（30/60など自由に変更OK）

    const $ = (id) => document.getElementById(id);

    const timeLeftEl = $("timeLeft");
    const qIndexEl = $("qIndex");
    const qTotalEl = $("qTotal");
    const barFillEl = $("barFill");
    const scoreNowEl = $("scoreNow");

    const questionTextEl = $("questionText");
    const questionHintEl = $("questionHint");
    const answersEl = $("answers");

    const feedbackEl = $("feedback");
    const badgeEl = $("badge");
    const explainEl = $("explainText");
    const nextBtn = $("nextBtn");

    const resultEl = $("result");
    const finalScoreEl = $("finalScore");
    const finalTotalEl = $("finalTotal");
    const elapsedEl = $("elapsed");
    const messageEl = $("message");
    const restartBtn = $("restartBtn");
    const copyBtn = $("copyBtn");
    const reviewEl = $("review");

    const toastEl = $("toast");

    let timer = null;
    let startedAt = null;
    let timeLeft = TOTAL_TIME_SEC;

    let idx = 0;
    let score = 0;
    let locked = false;

    const log = [];

    function showToast(text){
      toastEl.textContent = text;
      toastEl.classList.add("show");
      setTimeout(() => toastEl.classList.remove("show"), 1200);
    }

    // 選択肢をランダム化（マンネリ防止：3択でも有効）
    function shuffledQuestion(item){
      const pairs = item.a.map((label, i) => ({label, i}));
      for(let j=pairs.length-1; j>0; j--){
        const k = Math.floor(Math.random()*(j+1));
        [pairs[j], pairs[k]] = [pairs[k], pairs[j]];
      }
      const newA = pairs.map(p => p.label);
      const newCorrect = pairs.findIndex(p => p.i === item.correct);
      return {...item, a:newA, correct:newCorrect};
    }

    let quizRuntime = [];

    function start(){
      idx = 0;
      score = 0;
      locked = false;
      log.length = 0;

      timeLeft = TOTAL_TIME_SEC;
      timeLeftEl.textContent = timeLeft;

      feedbackEl.classList.remove("show");
      resultEl.classList.remove("show");

      quizRuntime = QUIZ.map(q => shuffledQuestion(q));

      qTotalEl.textContent = quizRuntime.length;
      finalTotalEl.textContent = quizRuntime.length;

      scoreNowEl.textContent = score;

      startedAt = Date.now();
      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        timeLeft -= 1;
        timeLeftEl.textContent = Math.max(0, timeLeft);
        if (timeLeft <= 0){
          clearInterval(timer);
          timer = null;
          finish(true);
        }
      }, 1000);

      renderQuestion();
    }

    function renderQuestion(){
      locked = false;
      feedbackEl.classList.remove("show");

      const total = quizRuntime.length;
      const q = quizRuntime[idx];

      qIndexEl.textContent = (idx + 1);
      barFillEl.style.width = `${Math.round((idx / total) * 100)}%`;

      questionTextEl.textContent = q.q;
      questionHintEl.textContent = q.hint ? `※ ${q.hint}` : "";

      answersEl.innerHTML = "";
      q.a.forEach((label, optionIndex) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.textContent = label;
        btn.addEventListener("click", () => choose(optionIndex));
        answersEl.appendChild(btn);
      });
    }

    function choose(optionIndex){
      if (locked) return;
      locked = true;

      const q = quizRuntime[idx];
      const ok = optionIndex === q.correct;

      if (ok) score += 1;
      scoreNowEl.textContent = score;

      log.push({
        q: q.q,
        picked: q.a[optionIndex],
        correct: q.a[q.correct],
        ok,
        explain: q.explain || ""
      });

      badgeEl.className = "badge " + (ok ? "ok" : "ng");
      badgeEl.textContent = ok ? "正解" : "不正解";

      const extra = !ok ? ` 正解は「${q.a[q.correct]}」です。` : "";
      explainEl.textContent = (q.explain || "") + extra;

      nextBtn.textContent = (idx < quizRuntime.length - 1) ? "次へ" : "結果を見る";

      feedbackEl.classList.add("show");
      nextBtn.focus();
    }

    nextBtn.addEventListener("click", () => {
      if (!locked) return;
      if (idx < quizRuntime.length - 1){
        idx += 1;
        renderQuestion();
      } else {
        finish(false);
      }
    });

    function finish(timeout){
      if (timer){ clearInterval(timer); timer = null; }

      while (log.length < quizRuntime.length){
        const q = quizRuntime[log.length];
        log.push({
          q: q.q,
          picked: timeout ? "（時間切れ）" : "（未回答）",
          correct: q.a[q.correct],
          ok: false,
          explain: q.explain || ""
        });
      }

      score = log.filter(x => x.ok).length;
      scoreNowEl.textContent = score;

      const elapsed = Math.min(TOTAL_TIME_SEC, Math.round((Date.now() - startedAt) / 1000));
      elapsedEl.textContent = elapsed;

      finalScoreEl.textContent = score;

      const total = quizRuntime.length;
      const rate = Math.round((score / total) * 100);
      let msg = "おつかれさまでした！";
      if (timeout) msg = "時間切れ！でもOK。次回またサクッと挑戦してみてください。";
      else if (rate === 100) msg = "満点！すばらしい！";
      else if (rate >= 80) msg = "かなり良い感じ！";
      else if (rate >= 60) msg = "いい調子。継続が強いです。";
      else if (rate >= 40) msg = "ナイス挑戦。次回も気軽にどうぞ。";
      else msg = "今日は肩慣らし。次回リベンジ！";
      messageEl.textContent = msg;

      reviewEl.innerHTML = "";
      log.forEach((it, i) => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="top">
            <div class="t">Q${i+1}</div>
            <span class="badge ${it.ok ? "ok":"ng"}">${it.ok ? "正解":"不正解"}</span>
          </div>
          <div class="t" style="margin-bottom:6px">${escapeHtml(it.q)}</div>
          <div class="a">あなた：${escapeHtml(it.picked)} ／ 正解：${escapeHtml(it.correct)}</div>
          ${it.explain ? `<div class="a" style="margin-top:6px">${escapeHtml(it.explain)}</div>` : ``}
        `;
        reviewEl.appendChild(div);
      });

      feedbackEl.classList.remove("show");
      answersEl.innerHTML = "";
      questionTextEl.textContent = "おつかれさまでした！";
      questionHintEl.textContent = "結果を確認できます。";
      barFillEl.style.width = "100%";
      resultEl.classList.add("show");
      restartBtn.focus();
    }

    restartBtn.addEventListener("click", () => start());

    copyBtn.addEventListener("click", async () => {
      const total = quizRuntime.length;
      const rate = Math.round((score / total) * 100);
      const text =
`脳トレ（お正月編）：3択クイズ
結果：${score}/${total}（正解率${rate}%）
もう一回やってみる？`;
      try{
        await navigator.clipboard.writeText(text);
        showToast("コピーしました");
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        showToast("コピーしました");
      }
    });

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (c) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[c]));
    }

    start();
  </script>
</body>
</html>
